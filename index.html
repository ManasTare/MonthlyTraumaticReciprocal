<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maze.io Multiplayer</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style> canvas { background: #111; display: block; margin: auto; } </style>
</head>
<body>
    <canvas id="gameCanvas"></canvas>
    <script>
        const socket = io("https://9a8cb75d-9b82-4109-b371-a44689595cb5-00-264cj26sz3fi6.pike.replit.dev/"); // Change this to your WebSocket server URL
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        const COLS = 15, ROWS = 15, CELL_SIZE = 40;
        canvas.width = COLS * CELL_SIZE;
        canvas.height = ROWS * CELL_SIZE;

        const players = {}; // Store all players
        let playerId = null;
        let playerPos = { x: 0, y: 0 };

        socket.on("connect", () => {
            playerId = socket.id;
        });

        socket.on("updatePlayers", (data) => {
            Object.assign(players, data);
            drawMaze();
        });

        function drawMaze() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            for (let id in players) {
                const p = players[id];
                ctx.fillStyle = id === playerId ? "blue" : "red";
                ctx.fillRect(p.x * CELL_SIZE + 10, p.y * CELL_SIZE + 10, CELL_SIZE - 20, CELL_SIZE - 20);
            }
        }

        function move(dx, dy) {
            playerPos.x += dx;
            playerPos.y += dy;
            socket.emit("move", playerPos);
        }

        document.addEventListener("keydown", (e) => {
            if (e.key === "ArrowUp") move(0, -1);
            if (e.key === "ArrowDown") move(0, 1);
            if (e.key === "ArrowLeft") move(-1, 0);
            if (e.key === "ArrowRight") move(1, 0);
        });

    </script>
</body>
</html>
